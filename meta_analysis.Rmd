---
title: "Meta Analysis"
author: "Quyen Duong"
date: "Last edited `r format(Sys.time(), '%d %B %Y')`"
output: html_document
---

```{r setup, include = FALSE}
# Set the default mode for all the chunks
knitr::opts_chunk$set(message = FALSE, warning = FALSE, fig.align = "center", 
                      fig.height = 8, fig.width = 8)
```


```{r load-packages, include=FALSE}
library(quantmod)         # download stock price
library(tidyverse)
library(dplyr)
library(ggplot2)
library(tseries)          # for ADF test
library(forecast)         # to predict price 
library(prophet)
```


# Introduction

The goal of the report is to compare three different machine learning methods to predict Meta stock price:

* ARIMA: Autoregressive integrated moving average
* GARCH: Generalized autoregressive conditional heteroskedasticity
* Prophet

```{r load-data}
# Downloading Meta ("FB") via Yahoo Finance API
Meta <- NULL
tickers_index <- c("FB")

for (Ticker in tickers_index) {
  Meta <- cbind(
    Meta,
    getSymbols.yahoo(
      Ticker,
      from = "2016-11-30",
      to = "2021-11-30",          # 5 years
      periodicity = "daily",
      auto.assign = FALSE
    )[, 6]                        # Only adjusted close
  )
}

# Assign to ts 
ts_meta <- ts(Meta[,-1], start = )

# Change Meta to dataframe
d_meta <- broom::tidy(Meta)

# Select relevant columns & change column names
d_meta <- d_meta %>% select(index, value) %>% 
  rename(date_meta = index, price_meta = value)

# Glimpse on the data
glimpse(d_meta)
```

## Descriptive analysis

Let's first have a look on the time series:

```{r plot-timeseries-continous return}
# Plot the time series
plot(Meta)

# Calculating continuous returns 
meta_returns <- na.omit(diff(log(Meta)))
colnames(meta_returns)<-"meta_returns"
```

It's essential to check the histogram of Meta returns. In this case, we plot the histogram and boxplot together in one graph

```{r histogram-return}
# Histogram
histogram_meta_return <- ggplot(meta_returns, mapping = aes(x = meta_returns)) +
  geom_histogram(color="black", fill = "grey", bins = 50) +
  #geom_density(alpha=.2, color ="blue") +
  scale_x_continuous() +
  labs(title = "Histogram and boxplot of Meta returns") +
  theme_minimal() +
  theme(plot.title = element_text(hjust = 0.5, face = "bold"))

# Boxplot
boxplot_meta_return <- ggplot(meta_returns, mapping = aes(x = "", y = meta_returns)) +
  geom_boxplot(color = "black", fill = "grey") +
  scale_y_continuous() +
  coord_flip() +
   xlab("") +
  theme_minimal()

# Display two plots together
egg::ggarrange(histogram_meta_return, boxplot_meta_return, heights = 2:1)
```

The histogram of Meta returns looks left skewed but let's check the basic statistics for skewness and kurtosis. 

```{r Skewness-Kurtosis}
psych::describe(meta_returns)
```

* Skew = -1.05: Substantial skewed distribution with long left tail. Two data point on the far left are the two sinks of the returns.
* Kurtosis = 12.83: 

```{r plot-return}
# Plot the returns
plot(meta_returns)
```


The Augmented Dickey-Fuller (ADF) test is now used to test whether a time series is (non-)stationary. 

$H_{0}: \rho = 1$: Time series has a unit root, hence, non-stationary, shows a trend over time 
$H_{1}: -1 < \rho < 1$

```{r ADF-test, include = TRUE}
# Conduct ADF test for dataset
adf.test(d_meta$price_meta)
```










